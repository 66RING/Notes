---
title: sketch wiki
author: 66RING
date: 2000-01-01
tags: 
- big data
mathjax: true
---

# sketch

- ref
    * https://zhuanlan.zhihu.com/p/521289977
    * https://zhuanlan.zhihu.com/p/369981005

海量数据完成存储不可能且没必要。我们希望用较少的空间来表示, 能容忍一定误差。

- 简单均匀随机抽样(Simply Sampling)
    * 多少样本对应多少误差?
        + 均匀随机, 样本数s, 则误差率: $1/\sqrt{s}$
    * 怎么保证随机?
        + 数据触发随机数
    * 新数据不断更新如何维护样本?
        + 概率加入/更新样本
    * e.g. DBMS查询优化, 用采样来评估方案性能
- 布隆过滤器
- Count-Min Sketch
    * 准确性换效率
    * 统计元素出现次数: 比如推文被引用的次数
        + 此时如果每个对象都有一个独立的计数器会比较浪费空间, 数值大时效率也低
    * 海量数据情景是准确的, 小量则不准确。多重布隆过滤器思想
    * 二维数组: m x n(计数器)。 **m个哈希函数**, 映射范围`[0, n]`
        + 每个哈希函数对应二维数组一行
    * 插入: 每行都hash一个计数器加1
    * 查询: 每行都找, 取最小值, 故称count-min
    * 因为可能哈希冲突, 所以取最小值计数器做近似
    * 为什么可行?
        1. 如果数据量是n, 对n的slot做hash就够了, 但是很多hash冲突, 效率降低
        2. 那就增加slot的数量, 但是如果是一维的线性增加还是会有冲突: 冲突率与数量的关系: 生日攻击
        3. 所以我们分几行hash, 多行同时冲突的概率低, 且只需要常数次哈希
