---
title: 暑期实习面试小结
author: 66RING
date: 2000-01-01
mathjax: true
---

# Preface

面试公司：阿里，字节，PingCAP

总结：大失败


# Overview

# 字节

- 操作系统的零拷贝技术
	* TODO
- 手写LRU
	* 翻车：我应该先问清楚应用场景的，**或者我应该主动说**: 那我们得具体问题具体分析，就假设如下场景吧: balabala(自己熟悉的场景)
		+ 然后面试官就了LRU的get, put操作，然后我并不知道put有什么用
	* 场景：分桶buffer cache
		1. 一个buffer的blockid相同，那么我们可以复用这个buffer(LRU从头到refcnt==0的节点)，移链首，然后返回
		2. 如果没有可以复用的buffer，那就找一个空的(refcnt==0)然后分配，移链首，返回
		3. 如果还是没有找到，因为是分桶的，从其他桶里找(从尾到头找)，找到后偷到当前链的链首
- raft
	* raft基本机制
	* raft防止脑裂的方法: args.Term > Term { becomefollower() }
	* raft节点数量有什么限制
		+ 奇数个：防止网络分区时两个分区都无法选出leader
- 网络相关：
	* 都了解什么协议
		+ 我：TCP，http
	* TCP怎么保证可靠
		+ 我：超时重传
	* TCP所在层
		+ 传输层
	* TCP和UDP区别
- IO多路复用：poll, epoll, select区别
	* [my blog](https://github.com/66ring/Notes/tree/master/universe/tech_tips/IO_multiplexing_intro.md)
	
- sum: 提问时间我应该问一下


# 阿里

阿里云自治服务(DAS)

## 一面

官：殷征

- 你的死锁检测脚本
	* 我先说明使用背景
		1. 直接debug go比较困难，很多很多goroutine，很多很多thread
		2. 而且，go对thread， goroutine这些又封装得厉害，`backtrace`看半天看不出个所以然
		3. 以防万一我都是直接"两段锁协议"的，基本不会出现交叉锁的情况(但是没考虑循环锁)
		4. 而且我不想用网上现成的死锁检测库破坏原本的项目结构
		5. 所以我面临的最主要文件是channel导致的死锁
		6. 然后我的脚本帮我发现了好几个corner case
	* 本质就是根据log判断，一进`>>>`要期待一出`<<<`，如果长时间没有响应，直接接收，然出输出没有得到响应的进`>>>`
- raft, paxos了解情况
- **了解僵尸进程吗**，怎么消除僵尸进程
	* 一个进程结束，但父进程没有`wait/waitpid`，那它将变为僵尸进程
	* 可以`ps`命令查看
- 用过哪些数据库
- cpu占用热点排查
- 你做的项目都由什么感觉，分享一下
- 平衡树, b, b+等
- 布隆过滤器
- 数据库索引了解多少
- docker镜像过大该怎么处理
	* 压缩，拆分
	* 精简镜像尺寸的好处
		+ 减小构造时间
		+ 减少磁盘使用量
		+ 减少下载时间
		+ 文件少，攻击面小，提高安全性
		+ 提供部署速度
	* 方法
		1. 优化基础镜像：如，可以在Ubuntu、CentOs、Alpine中选择Alpine
			- 再如`scratch镜像`, `busybox`镜像等
		2. 串联dockerfile指令：`cmd && cmd`
			- 使用太多RUN会导致镜像很多层，甚至超出上限127层 
		3. 多阶段构建
		4. 构建业务服务镜像技巧
		5. 压缩镜像


## 二面

- 深造就业的打算
	* 大失败，我应该说我相信主观能动性的
- 了解分布式锁吗
	* 应该考虑什么
		+ 死锁
		+ ...
- 分布式协议的应用场景
	* 怎么有效，安全地组织节点
- 了解数据库实现吗
	* 我说了笛卡尔积这样数学的，但是忘了说索引，大失败
	* 其实还可以说OLAP，OLTP，HTAP的考虑，可惜都忘了，大失败
- 很和蔼，但是感觉问得都很锋利hhh
	* 我知道感觉在哪了，我感觉这些问题是能突击出来的，但我却不知道，所以

大失败，只面试了45分钟，G

总结：其实有很多懂的可以说，但是感觉干干问一下子想不起来，**下次可以多主动要点提示**。真的是太多细节一下子想不到


# PingCap

## round 1

> 面试前一天进公司鱼塘了... 可能复核简历时刷了哈哈(55555)。
> 
> 结果是搞乌龙了，我是改面另一个部门，所以原来的部门当然就挂了

官：俞平

面了90分钟(好累, 复盘时都想不起什么了)。问了很多我简历上的(QEMU)，体验满分，因为问的都是设计上的问题，不是八股文。

- 为什么PingCap
- 根据我讲的QEMU一个一个问
	* 线程模型，为什么是事件驱动 TODO
	* QOM
	* 模拟流程
- c++如何实现多态
- c/cpp中如何防止内存泄露等问题
	* 我的答案是没有好办法，是我从rust中反推出的
		+ 然后开始问我rust了555
		+ 事后我想到也许可以使用静态分析工具
			+ 然后idea就来了，既然rust的通过编译器的大量检测实现的，那么静态分析工具是否可以在编写时检测，这样就不会向rust编译那般耗时了
	* 网上的答案
		+ 尽量使用只能指针而不是手动管理
		+ `std::string`内部做好了内存管理而不像`char*`
			+ 说这样可能就会被问string内部如何实现的😑
		+ 尽量避免在堆上分配内存
		+ 用户自定义的类型最好使用引用传参
		+ 在类的构造函数与析构函数中匹配的调用new和delete
		+ 在释放对象数组时，使用delete []
- rust如何获取多个可变引用
	* TOOD
- tcp如何保证可靠传输
- 大数据了解情况: e.g. mapreduce
- rockDB
	* 我不知道然后给他回了我了解的B+树

TODO

编程题简单，但是我没写对。求二叉搜索树第三大的节点。


大失败!!!!!




# 总结

- 面试写代码可以来点`assertion`
- 我面试真的太随便了，想到啥说啥，语速快逻辑性也没组织好。
- 我的学习路线太容易随大流了，什么都感兴趣，什么都学了一点但不精通。咳咳咳
- 大失败





